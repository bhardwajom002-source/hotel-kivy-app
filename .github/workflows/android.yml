- name: Install Android SDK (Correct sdkmanager)
  run: |
    # Create SDK directory
    mkdir -p /home/runner/android-sdk

    # Set env variables
    echo "ANDROID_HOME=/home/runner/android-sdk" >> $GITHUB_ENV
    echo "ANDROID_SDK_ROOT=/home/runner/android-sdk" >> $GITHUB_ENV

    # Download Android command line tools
    cd /home/runner
    wget https://dl.google.com/android/repository/commandlinetools-linux-11076708_latest.zip
    unzip commandlinetools-linux-11076708_latest.zip

    # Proper directory structure (VERY IMPORTANT)
    mkdir -p android-sdk/cmdline-tools/latest
    mv cmdline-tools/* android-sdk/cmdline-tools/latest/

    # Use CORRECT sdkmanager path
    export PATH=/home/runner/android-sdk/cmdline-tools/latest/bin:$PATH

    # Accept licenses
    yes | sdkmanager --licenses

    # Install required SDK packages (includes AIDL)
    sdkmanager \
      "platform-tools" \
      "platforms;android-33" \
      "build-tools;30.0.3" \
      "ndk;25.2.9519653"

    # Make aidl available globally
    echo "/home/runner/android-sdk/build-tools/30.0.3" >> $GITHUB_PATH
